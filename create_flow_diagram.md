# LinkFastAPINext_Practical-main の「create機能」の流れ図

## 🎯 全体の流れ（簡単に言うと）

```
ユーザーがフォームに情報を入力 → フロントエンドがバックエンドに送信 → バックエンドがデータベースに保存 → 結果をフロントエンドに返す → 画面に表示
```

## 📋 詳細な流れ図

### 1️⃣ フロントエンド（ユーザーが操作する画面）

#### 📝 入力画面（`frontend/src/app/customers/create/page.jsx`）
```
┌─────────────────────────────────────┐
│          顧客作成フォーム              │
├─────────────────────────────────────┤
│ 名前: [桃太郎] ← ユーザーが入力        │
│ Customer ID: [C030] ← 必須項目       │
│ 年齢: [30]                          │
│ 性別: [女]                          │
│                                     │
│        [作成] ボタン ← クリック       │
└─────────────────────────────────────┘
```

#### 🔄 データ送信処理（`frontend/src/app/customers/create/createCustomer.js`）
```
ユーザーが「作成」ボタンをクリック
    ↓
フォームの情報を集める
    ↓
JSONデータに変換
{
  "customer_name": "桃太郎",
  "customer_id": "C030",
  "age": 30,
  "gender": "女"
}
    ↓
バックエンドの `/customers` にPOSTリクエスト送信
```

### 2️⃣ バックエンド（サーバー側の処理）

#### 🚪 入り口（`backend/app.py`）
```
┌─────────────────────────────────────┐
│        FastAPI サーバー              │
├─────────────────────────────────────┤
│ POST /customers エンドポイント       │
│ ← フロントエンドからのリクエストを受け取る │
└─────────────────────────────────────┘
```

#### ✅ データチェック
```
受け取ったデータをチェック
    ↓
Customer IDが空でないか確認
    ↓
問題なければ次の処理へ
```

#### 💾 データベース保存（`backend/db_control/crud.py`）
```
┌─────────────────────────────────────┐
│        データベース操作               │
├─────────────────────────────────────┤
│ 1. MySQLデータベースに接続           │
│ 2. customersテーブルに新しい行を追加  │
│ 3. 保存が成功したかチェック          │
│ 4. 保存したデータを取得して返す      │
└─────────────────────────────────────┘
```

#### 🗄️ データベース（MySQL）
```
┌─────────────────────────────────────┐
│        customers テーブル             │
├─────────────────────────────────────┤
│ customer_id | customer_name | age | gender │
├─────────────────────────────────────┤
│ C030       | 桃太郎         | 30  | 女     │ ← 新しく追加
│ C001       | 田中太郎       | 25  | 男     │
│ C002       | 佐藤花子       | 28  | 女     │
└─────────────────────────────────────┘
```

### 3️⃣ レスポンス（結果の返し方）

#### 📤 バックエンドからフロントエンドへ
```
保存したデータをJSON形式で返す
{
  "customer_id": "C030",
  "customer_name": "桃太郎",
  "age": 30,
  "gender": "女"
}
```

### 4️⃣ フロントエンドでの表示

#### ✅ 確認画面（`frontend/src/app/customers/create/confirm/page.jsx`）
```
┌─────────────────────────────────────┐
│          作成完了画面                │
├─────────────────────────────────────┤
│        ✅ 正常に作成しました         │
│                                     │
│ ┌─────────────────────────────────┐ │
│ │        顧客情報カード            │ │
│ │ 名前: 桃太郎                    │ │
│ │ Customer ID: C030              │ │
│ │ 年齢: 30                       │ │
│ │ 性別: 女                       │ │
│ └─────────────────────────────────┘ │
│                                     │
│        [戻る] ボタン               │
└─────────────────────────────────────┘
```

## 🔧 技術的な詳細（中学生向け説明）

### ファイルの役割

#### フロントエンド（Next.js）
- **`page.jsx`**: ユーザーが入力するフォーム画面
- **`createCustomer.js`**: データをバックエンドに送信する処理
- **`confirm/page.jsx`**: 作成完了を表示する画面

#### バックエンド（FastAPI）
- **`app.py`**: リクエストを受け取る入り口
- **`crud.py`**: データベースの操作（保存・取得など）
- **`connect_MySQL.py`**: データベースとの接続設定

#### データベース（MySQL）
- **`customers`テーブル**: 顧客情報を保存する場所

### データの流れ
1. **入力** → ユーザーがフォームに情報を入力
2. **送信** → フロントエンドがバックエンドにデータを送信
3. **保存** → バックエンドがデータベースに情報を保存
4. **取得** → 保存したデータをデータベースから取得
5. **返送** → バックエンドがフロントエンドに結果を返送
6. **表示** → フロントエンドが結果を画面に表示

## 🎓 まとめ

create機能は、ユーザーが入力した情報を、フロントエンド → バックエンド → データベース → バックエンド → フロントエンドという流れで処理し、最終的に作成完了画面を表示する仕組みです。

各段階でデータの形式や処理内容が変わり、それぞれのファイルが特定の役割を担っています。 